-- BÁSICO
CREATE DATABASE virtualdc;

USE virtualdc;

CREATE TABLE cadfun (
	CODFUN INT NOT NULL PRIMARY KEY,
	NOME VARCHAR(40) NOT NULL,
	DEPTO CHAR(2),
	FUNCAO CHAR(20),
	SALARIO DECIMAL(10,2)
);


-- INSERT
INSERT INTO cadfun ( CODFUN, NOME, DEPTO, FUNCAO, SALARIO ) VALUES ( 16, 'Caio', '2', 'ADM', 15000.00 ); 
INSERT INTO cadfun ( CODFUN, NOME, DEPTO, FUNCAO, SALARIO ) VALUES ( 17, 'José', '6', 'Vendedor', 1600.00 ); 

INSERT INTO cadfun VALUES ( 18, 'Carla', '9', 'Programadora', 5700.00 );
INSERT INTO cadfun VALUES ( 19, 'Alex', '6', 'Vendedor', 1600.00 ); 
INSERT INTO cadfun VALUES ( 25, 'aaaaaaaaaaaa', '9', 'num sei', 99999.00 );


-- SELECTS
SELECT * FROM cadfun;
SELECT* FROM cadfun WHERE (SALARIO >= 1000 AND SALARIO <= 2000);
SELECT * FROM cadfun ORDER BY NOME DESC;
SELECT * FROM cadfun ORDER BY SALARIO;
SELECT * FROM cadfun WHERE DEPTO = '6' ORDER BY SALARIO;
SELECT TOP 2 CODFUN FROM cadfun;


-- UPDATE
UPDATE cadfun SET CODFUN = 1, SALARIO = 25000.00 WHERE CODFUN = 16;


-- DELETE
DELETE FROM cadfun WHERE CODFUN = 25;


-- ALTER TABLE
ALTER TABLE cadfun ADD ADMISSAO DATE;
SELECT * FROM cadfun;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 1;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 17;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 18;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 19;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 55;
UPDATE cadfun SET ADMISSAO = '21-05-2020' WHERE CODFUN = 56;
UPDATE cadfun SET ADMISSAO = '22-05-2020' WHERE CODFUN = 57;
UPDATE cadfun SET ADMISSAO = '23-05-2020' WHERE CODFUN = 58;
UPDATE cadfun SET ADMISSAO = '24-05-2020' WHERE CODFUN = 59;
UPDATE cadfun SET ADMISSAO = '25-05-2020' WHERE CODFUN = 60;
UPDATE cadfun SET ADMISSAO = '26-05-2020' WHERE CODFUN = 61;
UPDATE cadfun SET ADMISSAO = '27-05-2020' WHERE CODFUN = 62;
UPDATE cadfun SET ADMISSAO = '28-05-2020' WHERE CODFUN = 63;
UPDATE cadfun SET ADMISSAO = '29-05-2020' WHERE CODFUN = 64;
UPDATE cadfun SET ADMISSAO = '30-05-2020' WHERE CODFUN = 65;
UPDATE cadfun SET ADMISSAO = '01-06-2020' WHERE CODFUN = 66;
UPDATE cadfun SET ADMISSAO = '01-06-2020' WHERE CODFUN = 67;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 68;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 69;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 70;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 71;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 72;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 73;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 74;
UPDATE cadfun SET ADMISSAO = '20-05-2020' WHERE CODFUN = 75; 
SELECT SUM(SALARIO) AS TOTAL FROM cadfun;
UPDATE cadfun SET SALARIO = SALARIO * 1.20 FROM cadfun WHERE DEPTO = '10';
SELECT * FROM cadfun;

ALTER TABLE cadfun ADD DATANASCIMENTO DATE;
UPDATE cadfun SET DATANASCIMENTO = '10-05-2000' WHERE CODFUN = 1;
UPDATE cadfun SET DATANASCIMENTO = '15-05-1997' WHERE CODFUN = 17;
UPDATE cadfun SET DATANASCIMENTO = '10-05-1989' WHERE CODFUN = 18;
UPDATE cadfun SET DATANASCIMENTO = '06-01-1999' WHERE CODFUN = 19;
UPDATE cadfun SET DATANASCIMENTO = '15-12-2001' WHERE CODFUN = 55;
UPDATE cadfun SET DATANASCIMENTO = '19-08-1995' WHERE CODFUN = 56;
UPDATE cadfun SET DATANASCIMENTO = '23-03-1998' WHERE CODFUN = 57;
UPDATE cadfun SET DATANASCIMENTO = '16-05-1998' WHERE CODFUN = 58;
UPDATE cadfun SET DATANASCIMENTO = '24-01-2000' WHERE CODFUN = 59;
UPDATE cadfun SET DATANASCIMENTO = '01-02-2003' WHERE CODFUN = 60;
UPDATE cadfun SET DATANASCIMENTO = '02-02-2002' WHERE CODFUN = 61;
UPDATE cadfun SET DATANASCIMENTO = '11-06-2000' WHERE CODFUN = 62;
UPDATE cadfun SET DATANASCIMENTO = '14-12-2001' WHERE CODFUN = 63;
UPDATE cadfun SET DATANASCIMENTO = '01-02-2003' WHERE CODFUN = 64;
UPDATE cadfun SET DATANASCIMENTO = '02-02-2002' WHERE CODFUN = 65;
UPDATE cadfun SET DATANASCIMENTO = '03-03-2003' WHERE CODFUN = 66;
UPDATE cadfun SET DATANASCIMENTO = '04-04-2004' WHERE CODFUN = 67;
UPDATE cadfun SET DATANASCIMENTO = '01-01-2000' WHERE CODFUN = 68;
UPDATE cadfun SET DATANASCIMENTO = '01-02-1980' WHERE CODFUN = 69;
UPDATE cadfun SET DATANASCIMENTO = '02-06-1998' WHERE CODFUN = 70;
UPDATE cadfun SET DATANASCIMENTO = '06-06-1978' WHERE CODFUN = 71;
UPDATE cadfun SET DATANASCIMENTO = '08-05-1975' WHERE CODFUN = 72;
UPDATE cadfun SET DATANASCIMENTO = '09-09-1979' WHERE CODFUN = 73;
UPDATE cadfun SET DATANASCIMENTO = '14-12-1912' WHERE CODFUN = 74;
UPDATE cadfun SET DATANASCIMENTO = '06-06-1970' WHERE CODFUN = 75;
SELECT * FROM cadfun WHERE SALARIO > 85000 ORDER BY NOME, DEPTO;


-- EXCS:

-- EXC: Liste a data de nascimento e o nome dos funcionários ordenados dos mais novos para os mais velhos
select DATANASCIMENTO, NOME FROM cadfun ORDER BY DATANASCIMENTO DESC, NOME;


SELECT * FROM cadfun WHERE (DEPTO = '10') OR (DEPTO = '6') ORDER BY NOME;

SELECT * FROM cadfun WHERE (DEPTO = '6' AND (NOT FUNCAO = 'Estágiario')) OR ((NOT DEPTO = '6') AND (FUNCAO = 'Estágiario'));

ALTER TABLE cadfun ADD FILHOS SMALLINT;
UPDATE cadfun SET FILHOS = 1 WHERE CODFUN = 17;
UPDATE cadfun SET FILHOS = 1 WHERE CODFUN = 18;
UPDATE cadfun SET FILHOS = 1 WHERE CODFUN = 19;
SELECT * FROM cadfun;
SELECT NOME, FILHOS FROM cadfun;

SELECT CODFUN, NOME, FILHOS FROM cadfun WHERE FILHOS IS NULL;
SELECT CODFUN, NOME, FILHOS FROM cadfun WHERE NOT FILHOS IS NULL;
SELECT CODFUN, NOME, SALARIO FROM cadfun WHERE SALARIO NOT BETWEEN 10000 AND 100000 ORDER BY NOME;
SELECT CODFUN, NOME, SALARIO FROM cadfun WHERE SALARIO BETWEEN 10000 AND 100000 ORDER BY NOME;